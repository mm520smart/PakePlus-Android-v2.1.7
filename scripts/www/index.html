<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´ªåƒè›‡æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            max-width: 800px;
            width: 100%;
            text-align: center;
        }
        
        .header {
            margin-bottom: 25px;
        }
        
        h1 {
            font-size: 2.8rem;
            color: #00ff88;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .subtitle {
            color: #a0e7ff;
            font-size: 1.2rem;
            margin-bottom: 25px;
        }
        
        .game-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            align-items: flex-start;
        }
        
        .game-area {
            flex: 1;
            min-width: 300px;
        }
        
        .game-board {
            background-color: #0f3460;
            border-radius: 10px;
            border: 3px solid #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        #game-canvas {
            display: block;
            background-color: #0a1931;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .control-btn {
            padding: 15px;
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2979ff, #00b0ff);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
        }
        
        .control-btn:active {
            transform: scale(0.95);
            background: linear-gradient(135deg, #1c54b2, #0086c3);
        }
        
        .control-btn.up-down {
            grid-column: 2;
        }
        
        .game-info {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
            text-align: left;
        }
        
        .stats {
            margin-bottom: 25px;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-label {
            color: #a0e7ff;
            font-weight: 500;
        }
        
        .stat-value {
            color: #00ff88;
            font-weight: 700;
            font-size: 1.3rem;
        }
        
        #score {
            font-size: 1.8rem;
            text-shadow: 0 0 8px rgba(0, 255, 136, 0.7);
        }
        
        .settings {
            margin-bottom: 25px;
        }
        
        h3 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .setting-row {
            margin-bottom: 15px;
        }
        
        .setting-label {
            display: block;
            margin-bottom: 8px;
            color: #a0e7ff;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .slider-value {
            min-width: 40px;
            text-align: center;
            color: #00ff88;
            font-weight: bold;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #00ff88;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.7);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .game-btn {
            flex: 1;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        #start-btn {
            background: linear-gradient(135deg, #00c853, #00e676);
            color: #003918;
        }
        
        #start-btn:hover {
            background: linear-gradient(135deg, #00e676, #00ff88);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }
        
        #pause-btn {
            background: linear-gradient(135deg, #ff9100, #ffab00);
            color: #4a3000;
        }
        
        #pause-btn:hover {
            background: linear-gradient(135deg, #ffab00, #ffca28);
            box-shadow: 0 0 15px rgba(255, 171, 0, 0.5);
        }
        
        #reset-btn {
            background: linear-gradient(135deg, #ff1744, #f50057);
            color: white;
        }
        
        #reset-btn:hover {
            background: linear-gradient(135deg, #f50057, #ff4081);
            box-shadow: 0 0 15px rgba(245, 0, 87, 0.5);
        }
        
        .instructions {
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid #00ff88;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
        }
        
        .instructions p {
            margin-bottom: 10px;
            line-height: 1.5;
            color: #cccccc;
        }
        
        .key {
            display: inline-block;
            padding: 3px 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            border: 1px solid #00ff88;
            font-family: monospace;
            margin: 0 5px;
        }
        
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s;
        }
        
        .game-over.show {
            opacity: 1;
            visibility: visible;
        }
        
        .game-over-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 3px solid #00ff88;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }
        
        .game-over h2 {
            font-size: 3rem;
            color: #ff1744;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255, 23, 68, 0.7);
        }
        
        .final-score {
            font-size: 2.5rem;
            color: #00ff88;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .game-wrapper {
                flex-direction: column;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .control-btn.up-down {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ğŸ è´ªåƒè›‡æ¸¸æˆ</h1>
            <div class="subtitle">æ§åˆ¶è›‡åƒé£Ÿç‰©ï¼Œé¿å…æ’å¢™æˆ–å’¬åˆ°è‡ªå·±ï¼</div>
        </div>
        
        <div class="game-wrapper">
            <div class="game-area">
                <div class="game-board">
                    <canvas id="game-canvas" width="600" height="400"></canvas>
                </div>
                
                <div class="controls">
                    <button class="control-btn" id="left-btn">â† å·¦</button>
                    <button class="control-btn up-down" id="up-btn">â†‘ ä¸Š</button>
                    <button class="control-btn" id="right-btn">â†’ å³</button>
                    <div></div>
                    <button class="control-btn up-down" id="down-btn">â†“ ä¸‹</button>
                    <div></div>
                </div>
            </div>
            
            <div class="game-info">
                <div class="stats">
                    <h3>æ¸¸æˆçŠ¶æ€</h3>
                    <div class="stat-row">
                        <span class="stat-label">å¾—åˆ†</span>
                        <span class="stat-value" id="score">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">é•¿åº¦</span>
                        <span class="stat-value" id="length">1</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">é£Ÿç‰©</span>
                        <span class="stat-value" id="food-count">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">çŠ¶æ€</span>
                        <span class="stat-value" id="status">å‡†å¤‡å¼€å§‹</span>
                    </div>
                </div>
                
                <div class="settings">
                    <h3>æ¸¸æˆè®¾ç½®</h3>
                    <div class="setting-row">
                        <label class="setting-label">æ¸¸æˆé€Ÿåº¦</label>
                        <div class="slider-container">
                            <input type="range" id="speed-slider" min="5" max="20" value="10">
                            <span class="slider-value" id="speed-value">10</span>
                        </div>
                    </div>
                    <div class="setting-row">
                        <label class="setting-label">ç½‘æ ¼å¤§å°</label>
                        <div class="slider-container">
                            <input type="range" id="grid-slider" min="15" max="30" value="20">
                            <span class="slider-value" id="grid-value">20</span>
                        </div>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="game-btn" id="start-btn">å¼€å§‹æ¸¸æˆ</button>
                    <button class="game-btn" id="pause-btn">æš‚åœæ¸¸æˆ</button>
                    <button class="game-btn" id="reset-btn">é‡æ–°å¼€å§‹</button>
                </div>
                
                <div class="instructions">
                    <h3>æ¸¸æˆè¯´æ˜</h3>
                    <p>1. ä½¿ç”¨é”®ç›˜ <span class="key">â†‘</span> <span class="key">â†“</span> <span class="key">â†</span> <span class="key">â†’</span> æˆ–å±å¹•ä¸Šçš„æ–¹å‘é”®æ§åˆ¶è›‡çš„ç§»åŠ¨</p>
                    <p>2. åƒåˆ°çº¢è‰²é£Ÿç‰©å¯ä»¥å¢åŠ é•¿åº¦å’Œå¾—åˆ†</p>
                    <p>3. é¿å…æ’åˆ°å¢™å£æˆ–è‡ªå·±çš„èº«ä½“</p>
                    <p>4. è›‡è¶Šé•¿ï¼Œæ¸¸æˆéš¾åº¦è¶Šå¤§ï¼</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="game-over" id="game-over">
        <div class="game-over-content">
            <h2>æ¸¸æˆç»“æŸï¼</h2>
            <div class="final-score">æœ€ç»ˆå¾—åˆ†: <span id="final-score">0</span></div>
            <button class="game-btn" id="restart-btn" style="background: linear-gradient(135deg, #00c853, #00e676); padding: 15px 40px; font-size: 1.3rem;">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ ¸å¿ƒå˜é‡
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        
        // æ¸¸æˆçŠ¶æ€
        let game = {
            running: false,
            paused: false,
            score: 0,
            highScore: localStorage.getItem('snakeHighScore') || 0,
            speed: 10,
            gridSize: 20,
            snake: [],
            food: {x: 0, y: 0},
            direction: 'right',
            nextDirection: 'right',
            gameLoop: null,
            foodCount: 0
        };
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // è®¾ç½®è›‡çš„åˆå§‹ä½ç½®ï¼ˆåœ¨ç”»å¸ƒä¸­å¤®ï¼‰
            const startX = Math.floor(canvas.width / game.gridSize / 2) * game.gridSize;
            const startY = Math.floor(canvas.height / game.gridSize / 2) * game.gridSize;
            
            game.snake = [
                {x: startX, y: startY}
            ];
            
            // ç”Ÿæˆç¬¬ä¸€ä¸ªé£Ÿç‰©
            generateFood();
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            game.score = 0;
            game.direction = 'right';
            game.nextDirection = 'right';
            game.foodCount = 0;
            
            // æ›´æ–°UI
            updateUI();
        }
        
        // ç”Ÿæˆé£Ÿç‰©
        function generateFood() {
            const maxX = Math.floor(canvas.width / game.gridSize) - 1;
            const maxY = Math.floor(canvas.height / game.gridSize) - 1;
            
            let foodOnSnake;
            do {
                foodOnSnake = false;
                game.food.x = Math.floor(Math.random() * maxX) * game.gridSize;
                game.food.y = Math.floor(Math.random() * maxY) * game.gridSize;
                
                // æ£€æŸ¥é£Ÿç‰©æ˜¯å¦ç”Ÿæˆåœ¨è›‡èº«ä¸Š
                for (let segment of game.snake) {
                    if (segment.x === game.food.x && segment.y === game.food.y) {
                        foodOnSnake = true;
                        break;
                    }
                }
            } while (foodOnSnake);
        }
        
        // ç»˜åˆ¶æ¸¸æˆ
        function drawGame() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#0a1931';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶ç½‘æ ¼çº¿
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            
            // å‚ç›´çº¿
            for (let x = 0; x <= canvas.width; x += game.gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            // æ°´å¹³çº¿
            for (let y = 0; y <= canvas.height; y += game.gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶è›‡
            game.snake.forEach((segment, index) => {
                if (index === 0) {
                    // è›‡å¤´ - ç»¿è‰²
                    ctx.fillStyle = '#00ff88';
                    ctx.fillRect(segment.x, segment.y, game.gridSize, game.gridSize);
                    
                    // è›‡å¤´çœ¼ç›
                    ctx.fillStyle = '#000';
                    const eyeSize = game.gridSize / 5;
                    
                    // æ ¹æ®æ–¹å‘ç»˜åˆ¶çœ¼ç›
                    if (game.direction === 'right') {
                        ctx.fillRect(segment.x + game.gridSize - eyeSize*2, segment.y + eyeSize, eyeSize, eyeSize);
                        ctx.fillRect(segment.x + game.gridSize - eyeSize*2, segment.y + game.gridSize - eyeSize*2, eyeSize, eyeSize);
                    } else if (game.direction === 'left') {
                        ctx.fillRect(segment.x + eyeSize, segment.y + eyeSize, eyeSize, eyeSize);
                        ctx.fillRect(segment.x + eyeSize, segment.y + game.gridSize - eyeSize*2, eyeSize, eyeSize);
                    } else if (game.direction === 'up') {
                        ctx.fillRect(segment.x + eyeSize, segment.y + eyeSize, eyeSize, eyeSize);
                        ctx.fillRect(segment.x + game.gridSize - eyeSize*2, segment.y + eyeSize, eyeSize, eyeSize);
                    } else if (game.direction === 'down') {
                        ctx.fillRect(segment.x + eyeSize, segment.y + game.gridSize - eyeSize*2, eyeSize, eyeSize);
                        ctx.fillRect(segment.x + game.gridSize - eyeSize*2, segment.y + game.gridSize - eyeSize*2, eyeSize, eyeSize);
                    }
                } else {
                    // è›‡èº« - æ¸å˜è‰²
                    const colorValue = Math.max(50, 255 - index * 10);
                    ctx.fillStyle = `rgb(0, ${colorValue}, 100)`;
                    ctx.fillRect(segment.x, segment.y, game.gridSize, game.gridSize);
                    
                    // è›‡èº«å†…éƒ¨è£…é¥°
                    ctx.fillStyle = `rgba(0, 255, 136, 0.3)`;
                    ctx.fillRect(segment.x + 2, segment.y + 2, game.gridSize - 4, game.gridSize - 4);
                }
                
                // è›‡èº«è¾¹æ¡†
                ctx.strokeStyle = '#00ff88';
                ctx.lineWidth = 1;
                ctx.strokeRect(segment.x, segment.y, game.gridSize, game.gridSize);
            });
            
            // ç»˜åˆ¶é£Ÿç‰©
            ctx.fillStyle = '#ff1744';
            ctx.beginPath();
            const foodCenterX = game.food.x + game.gridSize / 2;
            const foodCenterY = game.food.y + game.gridSize / 2;
            const foodRadius = game.gridSize / 2 - 2;
            ctx.arc(foodCenterX, foodCenterY, foodRadius, 0, Math.PI * 2);
            ctx.fill();
            
            // é£Ÿç‰©å…‰æ³½æ•ˆæœ
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.beginPath();
            ctx.arc(foodCenterX - foodRadius/3, foodCenterY - foodRadius/3, foodRadius/4, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // æ›´æ–°æ¸¸æˆçŠ¶æ€
        function updateGame() {
            // æ›´æ–°è›‡çš„æ–¹å‘
            game.direction = game.nextDirection;
            
            // è·å–è›‡å¤´ä½ç½®
            const head = {...game.snake[0]};
            
            // æ ¹æ®æ–¹å‘ç§»åŠ¨è›‡å¤´
            switch (game.direction) {
                case 'up':
                    head.y -= game.gridSize;
                    break;
                case 'down':
                    head.y += game.gridSize;
                    break;
                case 'left':
                    head.x -= game.gridSize;
                    break;
                case 'right':
                    head.x += game.gridSize;
                    break;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ’å¢™
            if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height) {
                gameOver();
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ’åˆ°è‡ªå·±
            for (let segment of game.snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver();
                    return;
                }
            }
            
            // å°†æ–°å¤´éƒ¨æ·»åŠ åˆ°è›‡æ•°ç»„çš„å¼€å¤´
            game.snake.unshift(head);
            
            // æ£€æŸ¥æ˜¯å¦åƒåˆ°é£Ÿç‰©
            if (head.x === game.food.x && head.y === game.food.y) {
                // å¢åŠ åˆ†æ•°
                game.score += 10;
                game.foodCount++;
                
                // æ›´æ–°æœ€é«˜åˆ†
                if (game.score > game.highScore) {
                    game.highScore = game.score;
                    localStorage.setItem('snakeHighScore', game.highScore);
                }
                
                // ç”Ÿæˆæ–°é£Ÿç‰©
                generateFood();
                
                // æ¯å¾—50åˆ†å¢åŠ ä¸€ç‚¹é€Ÿåº¦
                if (game.score % 50 === 0 && game.speed < 20) {
                    game.speed++;
                    document.getElementById('speed-slider').value = game.speed;
                    document.getElementById('speed-value').textContent = game.speed;
                }
            } else {
                // å¦‚æœæ²¡æœ‰åƒåˆ°é£Ÿç‰©ï¼Œç§»é™¤è›‡å°¾
                game.snake.pop();
            }
            
            // æ›´æ–°UI
            updateUI();
            
            // ç»˜åˆ¶æ¸¸æˆ
            drawGame();
        }
        
        // æ¸¸æˆç»“æŸ
        function gameOver() {
            game.running = false;
            clearInterval(game.gameLoop);
            
            document.getElementById('final-score').textContent = game.score;
            document.getElementById('game-over').classList.add('show');
            document.getElementById('status').textContent = 'æ¸¸æˆç»“æŸ';
            document.getElementById('status').style.color = '#ff1744';
        }
        
        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            document.getElementById('score').textContent = game.score;
            document.getElementById('length').textContent = game.snake.length;
            document.getElementById('food-count').textContent = game.foodCount;
            document.getElementById('status').textContent = game.running ? (game.paused ? 'å·²æš‚åœ' : 'æ¸¸æˆä¸­') : 'å‡†å¤‡å¼€å§‹';
            document.getElementById('status').style.color = game.running ? '#00ff88' : '#a0e7ff';
        }
        
        // å¼€å§‹æ¸¸æˆå¾ªç¯
        function startGame() {
            if (!game.running) {
                initGame();
                drawGame();
            }
            
            game.running = true;
            game.paused = false;
            
            clearInterval(game.gameLoop);
            game.gameLoop = setInterval(updateGame, 1000 / game.speed);
            
            updateUI();
        }
        
        // æš‚åœ/ç»§ç»­æ¸¸æˆ
        function togglePause() {
            if (!game.running) return;
            
            game.paused = !game.paused;
            
            if (game.paused) {
                clearInterval(game.gameLoop);
            } else {
                game.gameLoop = setInterval(updateGame, 1000 / game.speed);
            }
            
            updateUI();
        }
        
        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            game.running = false;
            game.paused = false;
            clearInterval(game.gameLoop);
            
            initGame();
            drawGame();
            updateUI();
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ¸¸æˆ
            initGame();
            drawGame();
            
            // é”®ç›˜æ§åˆ¶
            document.addEventListener('keydown', function(event) {
                if (!game.running || game.paused) return;
                
                switch (event.key) {
                    case 'ArrowUp':
                        if (game.direction !== 'down') game.nextDirection = 'up';
                        event.preventDefault();
                        break;
                    case 'ArrowDown':
                        if (game.direction !== 'up') game.nextDirection = 'down';
                        event.preventDefault();
                        break;
                    case 'ArrowLeft':
                        if (game.direction !== 'right') game.nextDirection = 'left';
                        event.preventDefault();
                        break;
                    case 'ArrowRight':
                        if (game.direction !== 'left') game.nextDirection = 'right';
                        event.preventDefault();
                        break;
                    case ' ':
                        togglePause();
                        event.preventDefault();
                        break;
                }
            });
            
            // æŒ‰é’®æ§åˆ¶
            document.getElementById('start-btn').addEventListener('click', startGame);
            document.getElementById('pause-btn').addEventListener('click', togglePause);
            document.getElementById('reset-btn').addEventListener('click', resetGame);
            document.getElementById('restart-btn').addEventListener('click', function() {
                document.getElementById('game-over').classList.remove('show');
                resetGame();
                startGame();
            });
            
            // æ–¹å‘æŒ‰é’®
            document.getElementById('up-btn').addEventListener('click', function() {
                if (game.direction !== 'down') game.nextDirection = 'up';
            });
            
            document.getElementById('down-btn').addEventListener('click', function() {
                if (game.direction !== 'up') game.nextDirection = 'down';
            });
            
            document.getElementById('left-btn').addEventListener('click', function() {
                if (game.direction !== 'right') game.nextDirection = 'left';
            });
            
            document.getElementById('right-btn').addEventListener('click', function() {
                if (game.direction !== 'left') game.nextDirection = 'right';
            });
            
            // é€Ÿåº¦æ»‘å—
            const speedSlider = document.getElementById('speed-slider');
            const speedValue = document.getElementById('speed-value');
            
            speedSlider.addEventListener('input', function() {
                game.speed = parseInt(this.value);
                speedValue.textContent = game.speed;
                
                // å¦‚æœæ¸¸æˆæ­£åœ¨è¿è¡Œï¼Œæ›´æ–°æ¸¸æˆå¾ªç¯
                if (game.running && !game.paused) {
                    clearInterval(game.gameLoop);
                    game.gameLoop = setInterval(updateGame, 1000 / game.speed);
                }
            });
            
            // ç½‘æ ¼å¤§å°æ»‘å—
            const gridSlider = document.getElementById('grid-slider');
            const gridValue = document.getElementById('grid-value');
            
            gridSlider.addEventListener('input', function() {
                game.gridSize = parseInt(this.value);
                gridValue.textContent = game.gridSize;
                
                // é‡ç½®æ¸¸æˆä»¥åº”ç”¨æ–°çš„ç½‘æ ¼å¤§å°
                if (!game.running) {
                    initGame();
                    drawGame();
                }
            });
            
            // è§¦æ‘¸è®¾å¤‡æ§åˆ¶ä¼˜åŒ–
            let touchStartX = 0;
            let touchStartY = 0;
            
            canvas.addEventListener('touchstart', function(event) {
                if (!game.running || game.paused) return;
                
                touchStartX = event.touches[0].clientX;
                touchStartY = event.touches[0].clientY;
                event.preventDefault();
            }, {passive: false});
            
            canvas.addEventListener('touchmove', function(event) {
                event.preventDefault();
            }, {passive: false});
            
            canvas.addEventListener('touchend', function(event) {
                if (!game.running || game.paused) return;
                
                const touchEndX = event.changedTouches[0].clientX;
                const touchEndY = event.changedTouches[0].clientY;
                
                const dx = touchEndX - touchStartX;
                const dy = touchEndY - touchStartY;
                
                // ç¡®å®šæ»‘åŠ¨æ–¹å‘
                if (Math.abs(dx) > Math.abs(dy)) {
                    // æ°´å¹³æ»‘åŠ¨
                    if (dx > 0 && game.direction !== 'left') {
                        game.nextDirection = 'right';
                    } else if (dx < 0 && game.direction !== 'right') {
                        game.nextDirection = 'left';
                    }
                } else {
                    // å‚ç›´æ»‘åŠ¨
                    if (dy > 0 && game.direction !== 'up') {
                        game.nextDirection = 'down';
                    } else if (dy < 0 && game.direction !== 'down') {
                        game.nextDirection = 'up';
                    }
                }
                
                event.preventDefault();
            }, {passive: false});
        });
    </script>
</body>
</html>